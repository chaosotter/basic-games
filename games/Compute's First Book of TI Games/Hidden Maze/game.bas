100 CALL CLEAR
110 PRINT TAB(6);"***************"
120 PRINT TAB(6);"*";TAB(20);"*"
130 PRINT TAB(6);"* HIDDEN MAZE *"
140 PRINT TAB(6);"*";TAB(20);"*"
150 PRINT TAB(6);"***************"
160 PRINT : : :"USE THE ARROW KEYS TO GET"
170 PRINT :"OUT OF THE MAZE."
180 PRINT : :"TRY TO GET TO THE UPPER"
190 PRINT :"LEFT CORNER IN THE LEAST"
200 PRINT :"AMOUNT OF TIME."
210 CALL COLOR(10,5,5)
220 CALL COLOR(11,5,5)
230 CALL COLOR(13,12,12)
240 CALL COLOR(14,7,12)
250 CALL CHAR(136,"3C7EDBFFDBE77E3C")
260 PRINT : : :"PRESS ANY KEY TO BEGIN.";
270 CALL KEY(0,K,S)
280 IF S<1 THEN 270
290 CALL CLEAR
300 PRINT "GENERATING MAZE"
310 FOR X=3 TO 21
320 CALL HCHAR(X,3,104,27)
330 NEXT X
340 AY=4
350 AX=4
360 CALL HCHAR(AX,AY,117)
370 RANDOMIZE
380 J=INT(RND*4)
390 JJ=J
400 ON J+1 GOTO 410,440,470,500
410 DX=0
420 DY=2
430 GOTO 520
440 DX=-2
450 DY=0
460 GOTO 520
470 DX=0
480 DY=-2
490 GOTO 520
500 DX=2
510 DY=0
520 BX=AX+DX
530 BY=AY+DY
540 CALL GCHAR(BX,BY,G)
550 IF G<>104 THEN 620
560 CALL HCHAR(AX+DX/2,AY+DY/2,112)
570 CALL HCHAR(BX,BY,42)
580 CALL HCHAR(BX,BY,J+113)
590 AX=BX
600 AY=BY
610 GOTO 380
620 J=(J+1)*-(J<3)
630 IF J<>JJ THEN 400
640 CALL GCHAR(AX,AY,G)
650 CALL HCHAR(AX,AY,42)
660 CALL HCHAR(AX,AY,112)
670 ON G-112 GOTO 680,700,720,740,760
680 AY=AY-2
690 GOTO 380
700 AX=AX+2
710 GOTO 380
720 AY=AY+2
730 GOTO 380
740 AX=AX-2
750 GOTO 380
760 CALL SOUND(150,1497,2)
770 CALL HCHAR(23,3,32,15)
780 T=0
790 FOR A=15 TO 17
800 FOR B=19 TO 21
810 CALL GCHAR(A,B,G)
820 IF G=104 THEN 840
830 CALL HCHAR(A,B,128)
840 NEXT B
850 NEXT A
860 A=16
870 B=20
880 CALL HCHAR(A,B,136)
890 IF (A=4)+(B=4)=-2 THEN 1490
900 CALL KEY(1,K1,S)
910 T=T+1
920 IF (K1<0)+(K1>5)THEN 900
930 CALL HCHAR(A,B,128)
940 ON K1+1 GOTO 950,900,1100,1230,900,1360
950 CALL GCHAR(A+1,B,G)
960 IF G<>128 THEN 1080
970 CALL GCHAR(A+2,B-1,G)
980 IF G=104 THEN 1000
990 CALL HCHAR(A+2,B-1,128)
1000 CALL GCHAR(A+2,B,G)
1010 IF G=104 THEN 1030 
1020 CALL HCHAR(A+2,B,128)
1030 CALL GCHAR(A+2,B+1,G)
1040 IF G=104 THEN 1060
1050 CALL HCHAR(A+2,B+1,128)
1060 A=A+1
1070 GOTO 880
1080 CALL SOUND(100,-5,4)
1090 GOTO 880
1100 CALL GCHAR(A,B-1,G)
1110 IF G<>128 THEN 1080
1120 CALL GCHAR(A,B-2,G)
1130 IF G=104 THEN 1150
1140 CALL HCHAR(A,B-2,128)
1150 CALL GCHAR(A-1,B-2,G)
1160 IF G=104 THEN 1180
1170 CALL HCHAR(A-1,B-2,128) 
1180 CALL GCHAR(A+1,B-2,G)
1190 IF G=104 THEN 1210
1200 CALL HCHAR(A+1,B-2,128)
1210 B=B-1
1220 GOTO 880
1230 CALL GCHAR(A,B+1,G)
1240 IF G<>128 THEN 1080
1250 CALL GCHAR(A-1,B+2,G)
1260 IF G=104 THEN 1280
1270 CALL HCHAR(A-1,B+2,128)
1280 CALL GCHAR(A,B+2,G)
1290 IF G=104 THEN 1310
1300 CALL HCHAR(A,B+2,128)
1310 CALL GCHAR(A+1,B+2,G)
1320 IF G=104 THEN 1340
1330 CALL HCHAR(A+1,B+2,128)
1340 B=B+1
1350 GOTO 880
1360 CALL GCHAR(A-1,B,G)
1370 IF G<>128 THEN 1080
1380 CALL GCHAR(A-2,B-1,G)
1390 IF G=104 THEN 1410
1400 CALL HCHAR(A-2,B-1,128)
1410 CALL GCHAR(A-2,B,G)
1420 IF G=104 THEN 1440
1430 CALL HCHAR(A-2,B,128)
1440 CALL GCHAR(A-2,B+1,G)
1450 IF G=104 THEN 1470
1460 CALL HCHAR(A-2,B+1,128)
1470 A=A-1
1480 GOTO 880
1490 FOR I=1 TO 5
1500 CALL SOUND(-100,INT(RND*600)+700,4)
1510 CALL SCREEN(16)
1520 CALL SOUND(-100,INT(RND*600)+700,4)
1530 CALL SCREEN(11)
1540 CALL SOUND(-100,INT(RND*600)+700,4)
1550 CALL SCREEN(8)
1560 NEXT I
1570 PRINT "TIME =";T
1580 PRINT "TRY AGAIN? (Y/N)";
1590 CALL KEY(0,K,S)
1600 IF K=89 THEN 290
1610 IF K<>78 THEN 1590
1620 CALL CLEAR
1630 END
