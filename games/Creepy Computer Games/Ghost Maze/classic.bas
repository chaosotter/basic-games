5 RANDOMIZE TIMER
10 DIM E(70)
20 DIM V$(4, 3)
30 DIM F(3)
40 LET W$ = ""
50 LET W$ = W$ + "0000000000"
60 LET W$ = W$ + "0111100110"
70 LET W$ = W$ + "0010011100"
80 LET W$ = W$ + "0011010110"
90 LET W$ = W$ + "0110100100"
100 LET W$ = W$ + "0011111100"
110 LET W$ = W$ + "0000009000"
120 FOR I = 1 TO 70
130 LET E(I) = VAL(MID$(W$, I, 1))
140 NEXT I
150 LET S = -1
160 LET G = 12
170 LET X = INT(RND(1) * 50) + 10
180 IF E(X) <> 1 THEN GOTO 170
190 GOSUB 860
200 LET D = INT(RND(1) * 4) + 1
210 IF X = G + 10 OR X = G - 10 THEN GOTO 170
220 IF X = G + 1 OR X = G - 1 THEN GOTO 170
230 LET H = H + 1
240 IF H = 5 THEN GOSUB 860
250 GOSUB 390
260 LET A$ = INKEY$
270 IF A$ = "" THEN GOTO 260
280 IF A$ = "M" THEN LET D = D + 1
290 IF A$ = "N" THEN LET D = D - 1
300 IF D = 5 THEN LET D = 1
310 IF D = 0 THEN LET D = 4
320 IF A$ <> "X" THEN GOTO 210
330 IF D = 1 AND E(X - 10) <> 0 THEN LET X = X - 10
340 IF D = 3 AND E(X + 10) <> 0 THEN LET X = X + 10
350 IF D = 2 AND E(X + 1) <> 0 THEN LET X = X + 1
360 IF D = 4 AND E(X - 1) <> 0 THEN LET X = X - 1
370 IF E(X) = 9 THEN GOTO 930
380 GOTO 210
390 FOR I = 1 TO 4
400 LET T = I - 1
410 ON D GOTO 420, 460, 500, 540
420 LET F(1) = X - 10 * T + 1
430 LET F(2) = X - 10 * T
440 LET F(3) = X - 10 * T - 1
450 GOTO 570
460 LET F(1) = X + 10 * T
470 LET F(2) = X + T
480 LET F(3) = X - 10 * T
490 GOTO 570
500 LET F(1) = X + 10 * T - 1
510 LET F(2) = X + 10 * T
520 LET F(3) = X + 10 * T + 1
530 GOTO 570
540 LET F(1) = X - T - 10
550 LET F(2) = X - T
560 LET F(3) = X - T + 10
570 FOR J = 1 TO 3
580 IF F(J) < 1 OR F(J) > 69 THEN GOTO 840
590 IF E(F(J)) = 0 THEN LET V$(I, J) = "#"
600 IF E(F(J)) = 1 THEN LET V$(I, J) = " "
610 IF E(F(J)) = 9 THEN LET V$(I, J) = "+"
620 IF E(F(J)) = 2 THEN LET V$(I, J) = "G"
630 NEXT J
640 NEXT I
650 LET V$(1, 2) = "Y"
660 CLS
670 PRINT
680 PRINT "**** GHOST MAZE ****"
690 PRINT
700 PRINT "FORWARD       X"
710 PRINT "TURN RIGHT   M"
720 PRINT "TURN LEFT    N"
730 FOR I = 1 TO 5
740 PRINT
750 NEXT I
760 FOR I = 4 TO 1 STEP -1
770 LET P$ = ""
780 FOR J = 3 TO 1 STEP -1
790 LET P$ = P$ + V$(I, J)
800 NEXT J
810 PRINT TAB(7); P$
820 NEXT I
830 RETURN
840 LET V$(I, J) = "#"
850 GOTO 630
860 LET E(G) = 1
870 LET G = INT(RND(1) * 50) + 10
880 IF E(G) <> 1 THEN GOTO 870
890 LET E(G) = 2
900 LET H = 0
910 LET S = S + 1
920 RETURN
930 PRINT "YOU HAVE ESCAPED"
940 PRINT "IN "; S * 5 + H; " MOVES"
950 END

